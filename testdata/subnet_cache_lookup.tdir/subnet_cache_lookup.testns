ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
. IN NS
SECTION ANSWER
. IN NS test.ns.
SECTION ADDITIONAL
test.ns. IN A 127.0.0.1
ENTRY_END

; response to query of interest
ENTRY_BEGIN
;MATCH opcode qtype qname ednsdata
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
www.example.com. IN A
SECTION ANSWER
www.example.com. IN A	10.20.30.40
SECTION AUTHORITY
example.com.	IN NS	ns.example.com.
SECTION ADDITIONAL
HEX_EDNSDATA_BEGIN
			; client is 127.0.0.1
	00 08 		; OPC
	00 07 		; option length
	00 01 		; Family
	11 11 		; source mask, scopemask
	7f 00 00 	; address
HEX_EDNSDATA_END
ns.example.com.		IN 	A	1.2.3.4
ENTRY_END

ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
example.com. IN SOA
SECTION ANSWER
example.com. IN SOA ns.example.com. hostmaster.example.com. 1 3600 900 86400 3600
ENTRY_END

ENTRY_BEGIN
MATCH opcode qtype qname ednsdata
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
www.example.net. IN A
SECTION ADDITIONAL
HEX_EDNSDATA_BEGIN
			; client is 1.1.3.4
	00 08 		; OPC
	00 07 		; option length
	00 01 		; Family
	11 00 		; source mask, scopemask
	01 01 00 	; address
HEX_EDNSDATA_END
HEX_ANSWER_BEGIN
        00 00 84 00 00 01 00 01         ;ID 0, QR AA
        00 00 00 01 03 77 77 77         ; www.example.net. A? (DO)
        07 65 78 61 6d 70 6c 65
        03 6e 65 74 00 00 01 00
        01
					; www.example.net. A 10.20.30.41
	03 77 77 77 07 65 78 61 6d 70 6c 65 03 6e 65 74 00
	00 01 00 01 00 00 0e 10 00 04
	0a 14 1e 29

	00 00 29 10 00 00 00
        80 00 00 0b
        00 08 00 07                     ; OPC, optlen
        00 01 11 11                     ; ip4, scope 17, source 17
        01 01 00                        ;1.1.0.0/17
HEX_ANSWER_END
ENTRY_END

ENTRY_BEGIN
MATCH opcode qtype qname ednsdata
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
www.example.net. IN A
SECTION ADDITIONAL
HEX_EDNSDATA_BEGIN
			; client is 1.2.3.4
	00 08 		; OPC
	00 07 		; option length
	00 01 		; Family
	11 00 		; source mask, scopemask
	01 02 00 	; address
HEX_EDNSDATA_END
HEX_ANSWER_BEGIN
        00 00 84 00 00 01 00 01         ;ID 0, QR AA
        00 00 00 01 03 77 77 77         ; www.example.net. A? (DO)
        07 65 78 61 6d 70 6c 65
        03 6e 65 74 00 00 01 00
        01
					; www.example.net. A 10.20.30.42
	03 77 77 77 07 65 78 61 6d 70 6c 65 03 6e 65 74 00
	00 01 00 01 00 00 0e 10 00 04
	0a 14 1e 2a

	00 00 29 10 00 00 00
        80 00 00 0b
        00 08 00 07                     ; OPC, optlen
        00 01 11 11                     ; ip4, scope 17, source 17
        01 02 00                        ;1.2.0.0/17
HEX_ANSWER_END
ENTRY_END

ENTRY_BEGIN
MATCH opcode qtype qname ednsdata
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
www.example.net. IN A
SECTION ADDITIONAL
HEX_EDNSDATA_BEGIN
			; client is 1.3.3.4
	00 08 		; OPC
	00 07 		; option length
	00 01 		; Family
	11 00 		; source mask, scopemask
	01 03 00 	; address
HEX_EDNSDATA_END
HEX_ANSWER_BEGIN
        00 00 84 00 00 01 00 01         ;ID 0, QR AA
        00 00 00 01 03 77 77 77         ; www.example.net. A? (DO)
        07 65 78 61 6d 70 6c 65
        03 6e 65 74 00 00 01 00
        01
					; www.example.net. A 10.20.30.43
	03 77 77 77 07 65 78 61 6d 70 6c 65 03 6e 65 74 00
	00 01 00 01 00 00 0e 10 00 04
	0a 14 1e 2b

	00 00 29 10 00 00 00
        80 00 00 0b
        00 08 00 07                     ; OPC, optlen
        00 01 11 11                     ; ip4, scope 17, source 17
        01 03 00                        ;1.3.0.0/17
HEX_ANSWER_END
ENTRY_END

ENTRY_BEGIN
MATCH opcode qtype qname ednsdata
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
www.example.net. IN A
SECTION ADDITIONAL
HEX_EDNSDATA_BEGIN
			; client is 1.4.3.4
	00 08 		; OPC
	00 07 		; option length
	00 01 		; Family
	11 00 		; source mask, scopemask
	01 04 00 	; address
HEX_EDNSDATA_END
HEX_ANSWER_BEGIN
        00 00 84 00 00 01 00 01         ;ID 0, QR AA
        00 00 00 01 03 77 77 77         ; www.example.net. A? (DO)
        07 65 78 61 6d 70 6c 65
        03 6e 65 74 00 00 01 00
        01
					; www.example.net. A 10.20.30.44
	03 77 77 77 07 65 78 61 6d 70 6c 65 03 6e 65 74 00
	00 01 00 01 00 00 0e 10 00 04
	0a 14 1e 2c

	00 00 29 10 00 00 00
        80 00 00 0b
        00 08 00 07                     ; OPC, optlen
        00 01 11 11                     ; ip4, scope 17, source 17
        01 04 00                        ;1.4.0.0/17
HEX_ANSWER_END
ENTRY_END
